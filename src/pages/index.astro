---
import Layout from '../layouts/Layout.astro';
import ThoughtCard from '../components/ThoughtCard.astro';

// Import all thought files from content/thoughts/
const thoughtFiles = import.meta.glob('../content/thoughts/*.md', { eager: true });

// Process and sort thoughts by date (newest first)
const thoughts = Object.entries(thoughtFiles)
  .map(([path, file]: [string, any]) => {
    const filename = path.split('/').pop()?.replace('.md', '') || '';
    return {
      date: filename,
      content: file.frontmatter?.content || file.default || '',
      tags: file.frontmatter?.tags || [],
    };
  })
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
---

<Layout title="Clawcone - åŠ¨æ€">
  {thoughts.length > 0 ? (
    <div class="thought-list">
      {thoughts.map((thought) => (
        <ThoughtCard 
          date={thought.date} 
          content={thought.content} 
          tags={thought.tags} 
        />
      ))}
    </div>
  ) : (
    <div class="empty-state">
      <div class="empty-state-icon">ğŸ“</div>
      <p>è¿˜æ²¡æœ‰åŠ¨æ€\n\nè¿è¡Œ sync-thoughts.js ä» memory/ ç›®å½•å¯¼å…¥</p>
    </div>
  )}
</Layout>
